import{u as e,j as a,I as t,B as s,a6 as n,r as i,a4 as o,U as l,V as r}from"./index-32c3357d.js";import{o as c,P as d,D as m,a as u,b as x,d as h,s as j,T as p,S as k}from"./ShareModal-d881e5fb.js";import{R as y,u as f}from"./RobotOutlined-d916cdba.js";import{T as g,E as w}from"./index-8826920f.js";import{F as N}from"./index-8d9b92bb.js";import{u as q}from"./useQuery-77691717.js";import{R as S,C as I}from"./row-4d2b6eab.js";import"./__commonjsHelpers__-02d3be64.js";function C(){const{t:C}=e(),b=[{key:"email",title:C("token.email"),dataIndex:["account","email"],width:120,render:e=>a.jsx(t,{value:e,onClick:a=>c(e,C,a),readOnly:!0})},{key:"uniqueName",title:"Unique Name",dataIndex:"uniqueName",align:"center",width:120},{key:"password",title:C("token.password"),dataIndex:"password",align:"center",width:120},{key:"expiresAt",title:C("token.expiresAt"),dataIndex:"expiresAt",align:"center",width:120,render:e=>""==e?"未知":e},{key:"comment",title:C("token.comment"),dataIndex:"comment",align:"center",render:e=>a.jsx(g.Text,{style:{maxWidth:500},ellipsis:!0,children:e})},{title:C("token.action"),key:"operation",align:"center",render:(e,t)=>a.jsxs(s.Group,{children:[a.jsx(n,{title:"登录并跳转至对话",placement:"bottom",children:a.jsx(s,{icon:a.jsx(y,{}),type:"primary",onClick:()=>K(t)})}),a.jsx(s,{icon:a.jsx(w,{}),type:"primary",onClick:()=>E(t)}),a.jsx(d,{title:C("token.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>B(t),children:a.jsx(s,{icon:a.jsx(m,{}),type:"primary",loading:A==t.accountId+t.uniqueName,danger:!0})})]})}],v=u(),F=x(),[T,_]=i.useState(!1),L=f(),[O]=N.useForm(),V=N.useWatch("email",O),z=N.useWatch("uniqueName",O),[A,R]=i.useState(void 0),[U,W]=i.useState({formValue:{...h},title:C("token.edit"),show:!1,onOk:e=>{W((e=>({...e,show:!1})))},onCancel:()=>{W((e=>({...e,show:!1})))}});i.useEffect((()=>{O.setFieldValue("email",L.get("email"))}),[L]);const E=e=>{W({formValue:e,title:C("token.edit"),show:!0,onOk:(e,a)=>{F.mutate(e,{onSuccess:()=>{W((e=>({...e,show:!1})))},onSettled:()=>a(!1)})},onCancel:()=>{W((e=>({...e,show:!1})))}})},K=e=>{_(!0),o.info({content:"正在跳转至对话...",key:"chatLogin",duration:5}),j.chatLoginShare(e.uniqueName,e.password).then((e=>{e&&window.open(e,"_blank")})).finally((()=>{_(!1)}))},B=e=>{R(e.accountId+e.uniqueName),v.mutate(e,{onSettled:()=>{R(void 0)}})},{data:D}=q({queryKey:["shareList","claude",V,z],queryFn:()=>j.searchShare("claude",V,z)});return a.jsxs(l,{direction:"vertical",size:"large",className:"w-full",children:[a.jsx(r,{children:a.jsx(N,{form:O,children:a.jsxs(S,{gutter:[16,16],children:[a.jsx(I,{span:6,lg:6,children:a.jsx(N.Item,{label:C("token.email"),name:"email",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:6,lg:6,children:a.jsx(N.Item,{label:"Unique Name",name:"uniqueName",className:"!mb-0",children:a.jsx(t,{})})}),a.jsx(I,{span:12,lg:12,children:a.jsxs("div",{className:"flex justify-end",children:[a.jsx(s,{onClick:()=>{O.resetFields()},children:C("token.reset")}),a.jsx(s,{type:"primary",className:"ml-4",onClick:()=>{O.validateFields().then((e=>{O.submit()}))},children:C("token.search")})]})})]})})}),a.jsx(r,{title:C("token.shareList"),children:a.jsx(p,{rowKey:e=>e.accountId+e.uniqueName,size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:b,dataSource:D,loading:T})}),a.jsx(k,{...U})]})}export{C as default};
