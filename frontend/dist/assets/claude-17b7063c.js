import{u as e,O as s,r as a,j as t,I as o,P as i,B as n,Q as r,U as l,V as c}from"./index-32c3357d.js";import{u as d,d as m,o as h,P as u,D as x,T as j,S as p}from"./ShareModal-d881e5fb.js";import{a as y}from"./accountService-983f3c33.js";import{u as f,a as k,b as w,c as S,C as T,E as g,B as C,S as K,R as N,A as V}from"./AccountModal-c4efbab5.js";import{F as v}from"./index-8d9b92bb.js";import{T as I,E as _}from"./index-8826920f.js";import{u as z}from"./useQuery-77691717.js";import{R as F,C as L}from"./row-4d2b6eab.js";import"./__commonjsHelpers__-02d3be64.js";function O(){const[O]=v.useForm(),{t:b}=e(),A=f(),E=k(),W=w(),q=S(),B=d(),G=s(),[M,P]=a.useState(-1),[Q,R]=a.useState(-1),Y=v.useWatch("email",O),D={id:void 0,email:"",accountType:"claude",password:"",refreshToken:"",accessToken:"",sessionKey:"",shared:0},[H,U]=a.useState({formValue:{id:void 0,sessionKey:"",email:"",accountType:"claude",password:"",refreshToken:""},title:"New",show:!1,onOk:(e,s)=>{e.id?E.mutate(e,{onSuccess:()=>{U((e=>({...e,show:!1,formValue:{...D}})))},onSettled:()=>s(!1)}):A.mutate(e,{onSuccess:()=>{U((e=>({...e,show:!1,formValue:{...D}})))},onSettled:()=>s(!1)})},onCancel:()=>{U((e=>({...e,show:!1,formValue:{...D}})))}}),[$,J]=a.useState({formValue:{...m,shareType:"claude"},title:"New",show:!1,onOk:(e,s)=>{s(!0),B.mutate(e,{onSuccess:()=>{J((e=>({...e,show:!1})))},onSettled:()=>{s(!1)}})},onCancel:()=>{J((e=>({...e,show:!1})))}}),X=[{title:b("token.email"),dataIndex:"email",ellipsis:!0,align:"center",render:e=>t.jsx(I.Text,{style:{maxWidth:200},ellipsis:!0,children:e})},{title:b("token.password"),dataIndex:"password",align:"center",ellipsis:!0,render:e=>t.jsx(I.Text,{style:{maxWidth:200},ellipsis:!0,children:e})},{title:"Session Key",dataIndex:"sessionKey",align:"center",width:150,render:(e,s)=>s.sessionKey?t.jsx(o,{value:s.sessionKey,onClick:e=>h(s.sessionKey,b,e),readOnly:!0}):t.jsx(i,{color:"error",children:"Empty"})},{title:b("token.shareStatus"),dataIndex:"shared",align:"center",width:100,render:(e,s)=>1==s.shared?t.jsx(T,{twoToneColor:"#52c41a"}):t.jsx(g,{twoToneColor:"#fa8c16"})},{title:b("token.updateTime"),dataIndex:"updateTime",align:"center",width:200},{title:b("token.share"),key:"share",align:"center",render:(e,s)=>t.jsxs(n.Group,{children:[t.jsx(C,{count:s.shareList?.length,style:{zIndex:9},children:t.jsx(n,{icon:t.jsx(K,{}),onClick:()=>G({pathname:"/admin/share/claude",search:`?email=${s.email}`}),children:b("token.shareList")})}),t.jsx(n,{icon:t.jsx(r,{}),onClick:()=>ee(s)})]})},{title:b("token.action"),key:"operation",align:"center",render:(e,s)=>t.jsxs(n.Group,{children:[t.jsx(u,{title:b("common.refreshConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>{R(s.id),q.mutate(s.id,{onSettled:()=>R(void 0)})},children:t.jsx(n,{icon:t.jsx(N,{}),type:"primary",loading:Q===s.id,children:b("common.refresh")},s.id)}),t.jsx(n,{onClick:()=>se(s),icon:t.jsx(_,{}),type:"primary"}),t.jsx(u,{title:b("common.deleteConfirm"),okText:"Yes",cancelText:"No",placement:"left",onConfirm:()=>{P(s.id),W.mutate(s.id,{onSuccess:()=>P(void 0)})},children:t.jsx(n,{icon:t.jsx(x,{}),type:"primary",loading:M===s.id,danger:!0})})]})}],{data:Z}=z({queryKey:["accounts","claude",Y],queryFn:()=>y.searchAccountList(Y,"claude")}),ee=e=>{J((s=>({...s,show:!0,title:b("token.share"),formValue:{...m,accountId:e.id,shareType:"claude"}})))},se=e=>{U((s=>({...s,show:!0,title:b("token.edit"),formValue:{...s.formValue,id:e.id,email:e.email,password:e.password,shared:e.shared,sessionKey:e.sessionKey}})))};return t.jsxs(l,{direction:"vertical",size:"large",className:"w-full",children:[t.jsx(c,{children:t.jsx(v,{form:O,children:t.jsxs(F,{gutter:[16,16],children:[t.jsx(L,{span:6,lg:6,children:t.jsx(v.Item,{label:b("token.email"),name:"email",className:"!mb-0",children:t.jsx(o,{})})}),t.jsx(L,{span:18,lg:18,children:t.jsxs("div",{className:"flex justify-end",children:[t.jsx(n,{onClick:()=>{O.resetFields()},children:b("token.reset")}),t.jsx(n,{type:"primary",className:"ml-4",children:b("token.search")})]})})]})})}),t.jsx(c,{title:b("token.accountList"),extra:t.jsx(l,{children:t.jsx(n,{type:"primary",onClick:()=>{U((e=>({...e,show:!0,title:b("token.createNew"),formValue:{id:void 0,email:"",password:"",sessionKey:"",accountType:"claude",shared:0,custom_type:"refresh_token",custom_token:""}})))},children:b("token.createNew")})}),children:t.jsx(j,{rowKey:"id",size:"small",scroll:{x:"max-content"},pagination:{pageSize:10},columns:X,dataSource:Z})}),t.jsx(V,{...H}),t.jsx(p,{...$})]})}export{O as default};
